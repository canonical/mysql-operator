{"uid":"32d611859744bce7","name":"test_build_and_deploy","fullName":"tests.integration.test_tls#test_build_and_deploy","historyId":"663d2a50a79cc88412d6bed2d2931671","time":{"start":1746667766980,"stop":1746667917081,"duration":150101},"description":"Build the charm and deploy 3 units to ensure a cluster is formed.","descriptionHtml":"<p>Build the charm and deploy 3 units to ensure a cluster is formed.</p>\n","status":"broken","statusMessage":"websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 50, in test_build_and_deploy\n    await deploy_and_scale_mysql(ops_test, charm)\n  File \"/root/spread_project/tests/integration/high_availability/high_availability_helpers.py\", line 147, in deploy_and_scale_mysql\n    await ops_test.model.wait_for_idle(\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/model.py\", line 3120, in wait_for_idle\n    app_status = await app.get_status()\n                 ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/application.py\", line 559, in get_status\n    full_status = await client_facade.FullStatus(patterns=None)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py\", line 483, in wrapper\n    reply = await f(*args, **kwargs)\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/_client8.py\", line 35, in FullStatus\n    reply = await self.rpc(msg)\n            ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py\", line 662, in rpc\n    result = await self.connection.rpc(msg, encoder=TypeEncoder)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py\", line 574, in rpc\n    await self._ws.send(outgoing)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py\", line 458, in send\n    async with self.send_context():\n  File \"/usr/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py\", line 933, in send_context\n    raise self.protocol.close_exc from original_exc\nwebsockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"event_loop","time":{"start":1746667766856,"stop":1746667766856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1746667766857,"stop":1746667766857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1746667766857,"stop":1746667766979,"duration":122},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"charm","time":{"start":1746667766857,"stop":1746667766857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1746667766979,"stop":1746667766979,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Build the charm and deploy 3 units to ensure a cluster is formed.","status":"broken","statusMessage":"websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n                                ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 433, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 112, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 155, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 108, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 80, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 50, in test_build_and_deploy\n    await deploy_and_scale_mysql(ops_test, charm)\n  File \"/root/spread_project/tests/integration/high_availability/high_availability_helpers.py\", line 147, in deploy_and_scale_mysql\n    await ops_test.model.wait_for_idle(\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/model.py\", line 3120, in wait_for_idle\n    app_status = await app.get_status()\n                 ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/application.py\", line 559, in get_status\n    full_status = await client_facade.FullStatus(patterns=None)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py\", line 483, in wrapper\n    reply = await f(*args, **kwargs)\n            ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/_client8.py\", line 35, in FullStatus\n    reply = await self.rpc(msg)\n            ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py\", line 662, in rpc\n    result = await self.connection.rpc(msg, encoder=TypeEncoder)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py\", line 574, in rpc\n    await self._ws.send(outgoing)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py\", line 458, in send\n    async with self.send_context():\n  File \"/usr/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py\", line 933, in send_context\n    raise self.protocol.close_exc from original_exc\nwebsockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])","steps":[],"attachments":[{"uid":"576928e242a7fc75","name":"log","source":"576928e242a7fc75.txt","type":"text/plain","size":2825}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1746667917110,"stop":1746667917110,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1746667917290,"stop":1746667918106,"duration":816},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1746667918107,"stop":1746667918107,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1746667918107,"stop":1746667918107,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1746667918107,"stop":1746667918107,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"fv-az1983-919"},{"name":"thread","value":"14377-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"d4b6d931e1b1523d","status":"unknown","time":{}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":5,"skipped":0,"passed":317,"unknown":7,"total":329},"items":[{"uid":"febaf7d19655c964","reportUrl":"../3752//#testresult/febaf7d19655c964","status":"passed","time":{"start":1746581475579,"stop":1746581799777,"duration":324198}},{"uid":"5891809637cd4bd4","reportUrl":"../3746//#testresult/5891809637cd4bd4","status":"passed","time":{"start":1746495569830,"stop":1746495872034,"duration":302204}},{"uid":"a26e2ed109861099","reportUrl":"../3745//#testresult/a26e2ed109861099","status":"passed","time":{"start":1746408582497,"stop":1746408874153,"duration":291656}},{"uid":"c4229e631c271f4d","reportUrl":"../3744//#testresult/c4229e631c271f4d","status":"passed","time":{"start":1746322249324,"stop":1746322552113,"duration":302789}},{"uid":"659f9037807a307f","reportUrl":"../3743//#testresult/659f9037807a307f","status":"passed","time":{"start":1746235822768,"stop":1746236126227,"duration":303459}},{"uid":"2af594f97dcf8538","reportUrl":"../3742//#testresult/2af594f97dcf8538","status":"passed","time":{"start":1746149382072,"stop":1746149665738,"duration":283666}},{"uid":"45ad678f54b92134","reportUrl":"../3741//#testresult/45ad678f54b92134","status":"passed","time":{"start":1746063015337,"stop":1746063321077,"duration":305740}},{"uid":"f9045d5e5a5e0e8a","reportUrl":"../3740//#testresult/f9045d5e5a5e0e8a","status":"passed","time":{"start":1745976633671,"stop":1745976896199,"duration":262528}},{"uid":"d19cd3a32c0f0690","reportUrl":"../3738//#testresult/d19cd3a32c0f0690","status":"passed","time":{"start":1745890781830,"stop":1745891120438,"duration":338608}},{"uid":"730f782c0a7144dd","reportUrl":"../3733//#testresult/730f782c0a7144dd","status":"passed","time":{"start":1745803783893,"stop":1745804071837,"duration":287944}},{"uid":"784c7f07027cb9f5","reportUrl":"../3732//#testresult/784c7f07027cb9f5","status":"passed","time":{"start":1745717410713,"stop":1745717695099,"duration":284386}},{"uid":"5d4459a6829e12f","reportUrl":"../3731//#testresult/5d4459a6829e12f","status":"passed","time":{"start":1745630960236,"stop":1745631260760,"duration":300524}},{"uid":"c72a0d3a8f9e9d52","reportUrl":"../3727//#testresult/c72a0d3a8f9e9d52","status":"passed","time":{"start":1745544583021,"stop":1745544875610,"duration":292589}},{"uid":"4e79ae8d36e1f18b","reportUrl":"../3725//#testresult/4e79ae8d36e1f18b","status":"passed","time":{"start":1745458173701,"stop":1745458468205,"duration":294504}},{"uid":"985bfe330176c96a","reportUrl":"../3724//#testresult/985bfe330176c96a","status":"passed","time":{"start":1745371801612,"stop":1745372092495,"duration":290883}},{"uid":"4eea566973141e67","reportUrl":"../3719//#testresult/4eea566973141e67","status":"passed","time":{"start":1745285410422,"stop":1745285720378,"duration":309956}},{"uid":"fb4c9d7df592c19e","reportUrl":"../3718//#testresult/fb4c9d7df592c19e","status":"passed","time":{"start":1745199009830,"stop":1745199325390,"duration":315560}},{"uid":"8998111dbc79672e","reportUrl":"../3717//#testresult/8998111dbc79672e","status":"passed","time":{"start":1745112611259,"stop":1745112920845,"duration":309586}},{"uid":"efa68de38a55f931","reportUrl":"../3716//#testresult/efa68de38a55f931","status":"passed","time":{"start":1745026130923,"stop":1745026419458,"duration":288535}},{"uid":"e4a671aff7f8e3a1","reportUrl":"../3715//#testresult/e4a671aff7f8e3a1","status":"passed","time":{"start":1744939811053,"stop":1744940120695,"duration":309642}}]},"tags":["asyncio","abort_on_fail"]},"source":"32d611859744bce7.json","parameterValues":[]}